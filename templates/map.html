<style>
    #map-container {
        height: calc(100vh - 6rem);
        position: relative;
    }

    #map {
        height: 100%;
    }

    #map-overlay {
        position: absolute;
        top: 3rem;
        right: 4rem;
        padding: 2rem;
        background-color: rgba(255, 255, 255, 0.8);
        height: 80%;
        overflow-y: scroll;
        overflow-x: clip;
    }

    .ft-listing {
        max-width: 540px;
    }

    .ft-listing-bottom {
        position: absolute;
        bottom: 1rem;
        width: 100%;
    }

    .ft-hours tbody tr th {
        padding-right: 2rem;
    }
</style>

<div id="map-container">
    <div id="map" ></div>

    <div id="vue-target" v-cloak>
        <div id="map-overlay">
            <div v-for="t in trucks">
                <div @click="toggle_expand_truck(t._idx)" class="ft-listing card mb-3">
                    <div class="row g-0">
                        <div class="col-md-4">
                            <img class="img-fluid rounded-start"
                                 src="https://via.placeholder.com/300"/>
                        </div>
                        <div class="col-md-8">
                            <div class="card-body">
                                <h5 class="card-title">{{ t.name }}</h5>
                                <p class="card-text fw-light fst-italic">{{ t.cuisine_type }}</p>

                                <div v-if="t.expanded">

                                    <h5>Reviews ({{t.reviews.length}})</h5>
                                    <div class="section" id="vue-target">
                                        <div v-if="review_add_mode" class="container block">
                                            <br>
                                            <div class="form">
                                                <div class="field">
                                                    <div class="control">
                                                        <textarea class="textarea" v-model="review_add_text"
                                                            placeholder="Leave a Review...">
                                                        </textarea>
                                                    </div>
                                                </div>
                                                <div class="field">
                                                    <div class="control">
                                                        <input type="submit" @click="add_review(t._idx)" value="Post"
                                                               class="btn btn-success btn-sm">
                                                        <input type="submit" @click="set_add_status(false)"
                                                               value="Cancel"
                                                               class="btn btn-warning btn-sm">
                                                    </div>
                                                </div>
                                            </div>
                                            <br><br>
                                        </div>
                                        <div class="container block">
                                            <div v-for="r in t.reviews">
                                                <div class="card mb-3">
                                                    <div class="card-body">
                                                        <h5 class="card-title">{{r.name}}</h5>
                                                        <div class="mb-2">
                                                            <!-- <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i>
                                                            <i class="fa fa-star"></i> -->
                                                        </div>
                                                        <p class="card-text text-small"><small>{{r.text}}</small>
                                                        </p>
                                                        <button v-if="current_user == r.created_by" @click="delete_review(t._idx, r._idx)" class="btn btn-danger btn-sm">
                                                            <i class="fa fa-trash"></i>
                                                        </button>
                                                    </div>
                                                    
                                                </div>
                                                    
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3 text-center">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>

                                    <div class="text-end">
                                        <button @click="set_add_status(true)"type="button" class="btn btn-small btn-primary">Add Review</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>

<script
        defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyArwSA0QWBxt4K01jIhJ9j5xTKXh2O4W3k&callback=initMap&v=weekly"
></script>